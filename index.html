<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carte des Talents</title>
  <link rel="stylesheet" href="/CartedesTalents/styles.css" />
  <!-- Redirect script disabled for local development -->
  <!--
  <script>
    (function () {
      var target = 'http://10.0.1.253:3000/CartedesTalents/';
      if (window.location.href.indexOf(target) === -1) {
        window.location.href = target;
      }
    })();
  </script>
  -->
</head>
<body>
  <header class="header">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
      <div>
        <h1>Carte des Talents</h1>
        <p class="subtitle">Plateforme des talents du d√©fi national</p>
      </div>
      <div style="display: flex; align-items: center; gap: 1rem;">
        <span id="user-info" class="user-info" style="color: var(--text-muted); font-size: 0.9rem;"></span>
        <button id="logout-btn-header" class="secondary" style="padding: 0.4rem 0.9rem; font-size: 0.85rem;">D√©connexion</button>
      </div>
    </div>
    <nav class="nav">
      <button data-section="profil">Profil</button>
      <button data-section="carte">Carte des talents</button>
      <button data-section="collaborateur">Trouver un collaborateur</button>
      <button data-section="admin-dashboard" class="nav-admin" id="admin-nav-btn" style="display: none;">‚öôÔ∏è Dashboard Admin</button>
      <button data-section="admin-users" class="nav-admin" id="admin-users-nav-btn" style="display: none;">üë• Gestion Utilisateurs</button>
    </nav>
  </header>

  <main>
    <!-- Section Profil -->
    <section id="section-profil" class="section active">
      <h2>Mon profil</h2>
      <div class="grid-2">
        <form id="profil-form" class="card">
          <h3>√âditer mon profil</h3>

          <label>Nom complet
            <input type="text" id="fullName" placeholder="Nom Pr√©nom" />
          </label>

          <label>√âtablissement / Organisation
            <input type="text" id="organization" placeholder="Lyc√©e, universit√©, entreprise..." />
          </label>

          <label>Comp√©tences (s√©par√©es par des virgules)
            <input type="text" id="skills" placeholder="ex : JavaScript, Design, Communication" />
          </label>

          <label>Passions / Centres d'int√©r√™t
            <input type="text" id="passions" placeholder="ex : Musique, Robotique, Sport" />
          </label>

          <label>Langues parl√©es
            <input type="text" id="languages" placeholder="ex : Fran√ßais (C2), Anglais (B2)" />
          </label>

          <label>Projets r√©alis√©s
            <textarea id="projects" rows="3" placeholder="Liste courte de projets avec une phrase chacun"></textarea>
          </label>

          <label>Disponibilit√©
            <select id="availability">
              <option value="">-- Choisir --</option>
              <option value="projets">Disponible pour des projets</option>
              <option value="aide">Disponible pour aider ponctuellement</option>
              <option value="mentorat">Disponible pour du mentorat</option>
            </select>
          </label>

          <button type="submit" class="primary">Enregistrer le profil</button>
        </form>

        <div class="card" id="profil-preview">
          <h3>Pr√©visualisation du profil</h3>
          <p class="profil-name" id="preview-name">Nom Pr√©nom</p>
          <p class="profil-org" id="preview-org">√âtablissement / Organisation</p>
          <p class="badge badge-unverified" id="preview-badge">‚úó Non v√©rifi√©</p>

          <div class="profil-section">
            <h4>Comp√©tences</h4>
            <div id="preview-skills" class="tags"></div>
          </div>

          <div class="profil-section">
            <h4>Passions</h4>
            <div id="preview-passions" class="tags"></div>
          </div>

          <div class="profil-section">
            <h4>Langues</h4>
            <div id="preview-languages" class="tags"></div>
          </div>

          <div class="profil-section">
            <h4>Projets r√©alis√©s</h4>
            <ul id="preview-projects"></ul>
          </div>

          <div class="profil-section">
            <h4>Disponibilit√©</h4>
            <p id="preview-availability" class="muted">Non renseign√©</p>
          </div>
          <button id="download-pdf" class="pdf-button">T√©l√©charger la carte des talents en PDF</button>
        </div>
      </div>
    </section>

    <!-- Section Carte des talents -->
    <section id="section-carte" class="section">
      <h2>Carte des talents (nuage de comp√©tences)</h2>
      <p class="muted">Bas√© sur les comp√©tences de tous les profils saisis localement.</p>
      <div id="skills-cloud" class="skills-cloud card"></div>
      <div id="skills-cloud-selection" class="card" hidden>
        <h3>Talents pour la comp√©tence : <span id="selected-skill"></span></h3>
        <ul id="selected-skill-talents"></ul>
      </div>
    </section>

    <!-- Section Trouver un collaborateur -->
    <section id="section-collaborateur" class="section">
      <h2>Trouver un collaborateur</h2>
      <div class="grid-2">
        <form id="search-form" class="card">
          <h3>Recherche avanc√©e</h3>
          <label>Comp√©tence recherch√©e
            <input type="text" id="search-skill" placeholder="ex : Python" />
          </label>

          <label>Langue
            <input type="text" id="search-language" placeholder="ex : Anglais" />
          </label>

          <label>Disponibilit√©
            <select id="search-availability">
              <option value="">Peu importe</option>
              <option value="projets">Projets</option>
              <option value="aide">Aide ponctuelle</option>
              <option value="mentorat">Mentorat</option>
            </select>
          </label>

          <label class="checkbox">
            <input type="checkbox" id="search-verified-only" />
            <span>Seulement les talents v√©rifi√©s</span>
          </label>

          <button type="submit" class="primary">Rechercher</button>
        </form>

        <div id="search-results" class="card">
          <h3>R√©sultats</h3>
          <ul id="search-results-list"></ul>
          <p id="search-empty" class="muted">Aucun r√©sultat pour le moment. Enregistre d'abord un ou plusieurs profils.</p>
        </div>
      </div>
    </section>

    <!-- Section Dashboard Admin -->
    <section id="section-admin-dashboard" class="section">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h2>Dashboard Administrateur</h2>
        <button id="refresh-dashboard" class="secondary">üîÑ Actualiser</button>
      </div>

      <!-- Statistiques simplifi√©es -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">üë•</div>
          <div class="stat-content">
            <div class="stat-value" id="stat-total-talents">0</div>
            <div class="stat-label">Total Profils</div>
          </div>
        </div>
        <div class="stat-card verified">
          <div class="stat-icon">‚úÖ</div>
          <div class="stat-content">
            <div class="stat-value" id="stat-verified-talents">0</div>
            <div class="stat-label">V√©rifi√©s</div>
          </div>
        </div>
        <div class="stat-card unverified">
          <div class="stat-icon">‚è≥</div>
          <div class="stat-content">
            <div class="stat-value" id="stat-unverified-talents">0</div>
            <div class="stat-label">Non V√©rifi√©s</div>
          </div>
        </div>
      </div>

      <!-- Recherche et filtres -->
      <div class="dashboard-card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
          <h3>Tous les Profils</h3>
          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <input type="text" id="admin-search" placeholder="Rechercher un profil..." class="admin-search-input" />
            <select id="admin-filter" class="admin-filter-select">
              <option value="all">Tous</option>
              <option value="verified">V√©rifi√©s uniquement</option>
              <option value="unverified">Non v√©rifi√©s uniquement</option>
            </select>
          </div>
        </div>
        
        <!-- Liste des profils -->
        <div id="admin-profiles-list" class="admin-profiles-container">
          <p class="muted" style="text-align: center; padding: 2rem;">Chargement des profils...</p>
        </div>
      </div>
    </section>

    <!-- Section Gestion Utilisateurs Admin -->
    <section id="section-admin-users" class="section">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h2>Gestion des Utilisateurs</h2>
        <button id="refresh-users" class="secondary">üîÑ Actualiser</button>
      </div>

      <!-- Cr√©ation d'utilisateurs -->
      <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); margin-bottom: 2rem;">
        <!-- Cr√©ation d'admin -->
        <div class="dashboard-card">
          <h3>Cr√©er un Administrateur</h3>
          <form id="create-admin-form">
            <div class="form-group">
              <label for="new-admin-username">Nom d'utilisateur</label>
              <input type="text" id="new-admin-username" placeholder="nouvel_admin" required />
            </div>
            <div class="form-group">
              <label for="new-admin-password">Mot de passe</label>
              <input type="password" id="new-admin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="3" />
            </div>
            <button type="submit" class="primary" style="width: 100%; margin-top: 0.5rem;">Cr√©er l'administrateur</button>
          </form>
          <div id="create-admin-message" style="margin-top: 1rem;"></div>
        </div>

        <!-- Cr√©ation d'utilisateur -->
        <div class="dashboard-card">
          <h3>Cr√©er un Utilisateur</h3>
          <form id="create-user-form">
            <div class="form-group">
              <label for="new-user-username">Nom d'utilisateur</label>
              <input type="text" id="new-user-username" placeholder="nouvel_utilisateur" required />
            </div>
            <div class="form-group">
              <label for="new-user-password">Mot de passe</label>
              <input type="password" id="new-user-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="3" />
            </div>
            <button type="submit" class="primary" style="width: 100%; margin-top: 0.5rem;">Cr√©er l'utilisateur</button>
          </form>
          <div id="create-user-message" style="margin-top: 1rem;"></div>
        </div>
      </div>

      <!-- Liste des utilisateurs -->
      <div class="dashboard-card">
        <h3>Utilisateurs</h3>
        <div id="admin-users-list" class="users-list">
          <p class="muted">Chargement des utilisateurs...</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>Int√©gration possible au d√©fi national¬†: filtrer par √©tablissement, r√©gion ou promotion (√† ajouter c√¥t√© serveur ou base de donn√©es).</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="/CartedesTalents/app.js"></script>
</body>
</html>
